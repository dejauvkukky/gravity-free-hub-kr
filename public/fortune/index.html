<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Garden - ì˜¤ëŠ˜ì˜ ìš´ì„¸</title>
    <link rel="stylesheet" href="../../assets/css/style.css?v=5">
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .fortune-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid #eee;
        }

        .fortune-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .zodiac-badge {
            background: var(--color-lemon);
            color: #d97706;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .link-btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background: #f9f9f9;
            border: 1px solid #eee;
            border-radius: 12px;
            text-align: left;
            text-decoration: none;
            color: #333;
            transition: all 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .link-btn:hover {
            background: white;
            border-color: var(--color-coral);
            transform: translateX(5px);
        }

        .bio-legend {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 10px;
            font-size: 0.8rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <a href="../dashboard.html" class="logo">â† Secret Garden</a>
            <span>ì˜¤ëŠ˜ì˜ ìš´ì„¸</span>
        </header>

        <div id="loading" class="p-4 text-center">ë¡œë”©ì¤‘...</div>

        <div id="content" class="p-4 hidden">
            <!-- User Selector -->
            <div style="margin-bottom: 20px; overflow-x: auto; white-space: nowrap; padding-bottom: 10px;"
                id="family-selector">
                <!-- Dynamically populated -->
            </div>

            <!-- Birthdate Setup (If missing) -->
            <div id="setup-section" class="fortune-card hidden">
                <h3 class="card-title">ğŸ‚ ìƒì¼ ë“±ë¡ì´ í•„ìš”í•´ìš”</h3>
                <p class="card-desc" style="margin-bottom: 15px;">ì •í™•í•œ ìš´ì„¸ í™•ì¸ì„ ìœ„í•´ ìƒë…„ì›”ì¼ì„ ì•Œë ¤ì£¼ì„¸ìš”.</p>
                <div class="input-group">
                    <input type="date" id="birthdate-input" class="input-field">
                </div>
                <button class="btn btn-primary" onclick="saveBirthdate()">ì €ì¥í•˜ê³  ìš´ì„¸ ë³´ê¸°</button>
            </div>

            <!-- Fortune Display -->
            <div id="fortune-section" class="hidden">
                <div class="text-center" style="margin-bottom: 20px;">
                    <h2 id="user-greeting" style="font-size: 1.5rem; color: var(--color-primary); margin-bottom: 5px;">
                        ì•ˆë…•í•˜ì„¸ìš”!</h2>
                    <p id="today-date" style="color: #666; font-size: 0.9rem;"></p>
                </div>

                <!-- Zodiac Info -->
                <div class="fortune-card">
                    <div class="fortune-header">
                        <span class="card-title" style="margin:0;">ğŸŒ  ë³„ìë¦¬ & ë </span>
                        <span id="zodiac-text" class="zodiac-badge">ë¬¼ë³‘ìë¦¬ / ìš©ë </span>
                    </div>
                    <p style="color: #555; line-height: 1.5; font-size: 0.95rem;">
                        ì˜¤ëŠ˜ì˜ ê¸°ìš´ì„ í™•ì¸í•´ë³´ì„¸ìš”.
                    </p>
                </div>

                <!-- Biorhythm -->
                <div class="fortune-card">
                    <h3 class="card-title">ğŸ§¬ ì˜¤ëŠ˜ì˜ ë°”ì´ì˜¤ë¦¬ë“¬</h3>
                    <div style="height: 200px; position: relative;">
                        <canvas id="bioChart"></canvas>
                    </div>
                    <div class="bio-legend">
                        <div class="legend-item"><span class="dot" style="background:#22c55e"></span>ì‹ ì²´</div>
                        <div class="legend-item"><span class="dot" style="background:#ef4444"></span>ê°ì„±</div>
                        <div class="legend-item"><span class="dot" style="background:#3b82f6"></span>ì§€ì„±</div>
                    </div>
                    <p id="bio-comment"
                        style="margin-top: 15px; font-size: 0.9rem; color: #555; text-align: center; background: #f0fdf4; padding: 10px; border-radius: 8px;">
                        ì»¨ë””ì…˜ ë¶„ì„ ì¤‘...
                    </p>
                </div>

                <!-- External Links -->
                <h3 style="font-size: 1.1rem; margin-bottom: 10px; color: #333;">ğŸ”® ìì„¸í•œ ìš´ì„¸ ë³´ëŸ¬ê°€ê¸°</h3>

                <a href="https://m.search.naver.com/search.naver?query=ì˜¤ëŠ˜ì˜ìš´ì„¸" target="_blank" class="link-btn">
                    <span>ë„¤ì´ë²„ ì˜¤ëŠ˜ì˜ ìš´ì„¸</span>
                    <span style="color:#ccc">Example ></span>
                </a>
                <a href="https://m.search.daum.net/search?w=tot&q=ì˜¤ëŠ˜ì˜ìš´ì„¸" target="_blank" class="link-btn">
                    <span>ë‹¤ìŒ ìš´ì„¸</span>
                    <span style="color:#ccc">Go ></span>
                </a>
                <a href="https://shinhan.haezone.com/inSaju.asp?bType=A104" target="_blank" class="link-btn">
                    <span>ì‹ í•œìƒëª… ë¬´ë£Œìš´ì„¸</span>
                    <span style="color:#ccc">Go ></span>
                </a>