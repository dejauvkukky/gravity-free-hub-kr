<!DOCTYPE html>

<div style="flex-grow: 1;"></div> <!-- Spacer -->
</div>

<!-- Scripts -->
<script src="../src/auth.js?v=3"></script>
<script type="module">
    import '../src/firebase.js?v=3'; // Ensures Firebase is initialized

    // Logic executes after imports
    // 1. Init Check
    AuthService.checkAuth();

    // 2. Set Date
    const now = new Date();
    const days = ['일', '월', '화', '수', '목', '금', '토'];
    document.getElementById('today-date').innerText =
        `${now.getFullYear()}년 ${now.getMonth() + 1}월 ${now.getDate()}일 (${days[now.getDay()]})`;

    // 3. User Name Logic (Robust)
    // Wait for auth state to confirm user info if session is empty
    firebase.auth().onAuthStateChanged(user => {
        if (user) {
            const storedName = sessionStorage.getItem('user_name');
            let displayName = '가족';

            if (storedName && storedName !== 'null') {
                displayName = storedName;
            } else if (user.email) {
                displayName = user.email.split('@')[0];
                // Update session for next time
                sessionStorage.setItem('user_email', user.email);
                sessionStorage.setItem('user_name', displayName);
            }
            document.getElementById('user-name').innerText = displayName;
        }
    });
</script>
</body>

</html>