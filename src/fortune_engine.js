
// Fortune Engine 3.0 (Grand Master Edition)
// 🌌 Western: Planetary Transits & Aspects (Astrology)
// 📜 Eastern: Daily Stem/Branch Iljin & Five Elements (Saju)
// ✨ Lucky Prescription: Color, Item, Number, Direction

// =============================================================================
// SECTION 1: WESTERN ASTROLOGY DATA (PLANETS & ZODIAC)
// =============================================================================

const ZODIAC_SIGNS = {
    "양자리": { element: "fire", ruler: "mars", traits: ["개척", "용기", "직관"] },
    "황소자리": { element: "earth", ruler: "venus", traits: ["안정", "감각", "끈기"] },
    "쌍둥이자리": { element: "air", ruler: "mercury", traits: ["소통", "호기심", "재치"] },
    "게자리": { element: "water", ruler: "moon", traits: ["감성", "보호", "공감"] },
    "사자자리": { element: "fire", ruler: "sun", traits: ["표현", "자존감", "열정"] },
    "처녀자리": { element: "earth", ruler: "mercury", traits: ["분석", "봉사", "디테일"] },
    "천칭자리": { element: "air", ruler: "venus", traits: ["조화", "관계", "미학"] },
    "전갈자리": { element: "water", ruler: "pluto", traits: ["통찰", "집중", "비밀"] },
    "사수자리": { element: "fire", ruler: "jupiter", traits: ["모험", "철학", "낙관"] },
    "염소자리": { element: "earth", ruler: "saturn", traits: ["구조", "책임", "야망"] },
    "물병자리": { element: "air", ruler: "uranus", traits: ["혁신", "이성", "독창"] },
    "물고기자리": { element: "water", ruler: "neptune", traits: ["꿈", "영감", "희생"] }
};

const PLANETARY_ASPECTS = [
    { name: "수성 역행 (Mercury Retrograde)", type: "challenge", desc: "소통의 오해와 전자기기 오류를 조심해야 하는 시기" },
    { name: "금성의 미소 (Venus Trine)", type: "harmony", desc: "사랑과 예술, 금전적인 흐름이 부드러워지는 시기" },
    { name: "화성의 질주 (Mars Conjunct)", type: "energy", desc: "행동력이 폭발하고 추진력이 강해지는 시기" },
    { name: "목성의 축복 (Jupiter Expansion)", type: "luck", desc: "작은 노력이 크게 확장되어 돌아오는 행운의 시기" },
    { name: "토성의 교훈 (Saturn Return)", type: "serious", desc: "현실을 직시하고 내실을 다져야 하는 성숙의 시기" },
    { name: "달의 차오름 (Full Moon Energy)", type: "emotion", desc: "내면의 감정이 고조되고 무의식이 깨어나는 시기" },
    { name: "태양의 입궁 (Solar Return)", type: "vitality", desc: "자신감이 넘치고 존재감이 드러나는 빛의 시기" }
];

// =============================================================================
// SECTION 2: EASTERN SAJU DATA (ILJIN & 5 ELEMENTS)
// =============================================================================

const FIVE_ELEMENTS = {
    "wood": { name: "목(木)", quality: "성장/시작", color: "청색" },
    "fire": { name: "화(火)", quality: "확산/열정", color: "적색" },
    "earth": { name: "토(土)", quality: "중재/변화", color: "황색" },
    "metal": { name: "금(金)", quality: "결실/냉철", color: "백색" },
    "water": { name: "수(水)", quality: "지혜/휴식", color: "흑색" }
};

const ORIENTAL_ZODIAC = {
    "쥐띠": "water", "소띠": "earth", "호랑이띠": "wood", "토끼띠": "wood",
    "용띠": "earth", "뱀띠": "fire", "말띠": "fire", "양띠": "earth",
    "원숭이띠": "metal", "닭띠": "metal", "개띠": "earth", "돼지띠": "water"
};

// =============================================================================
// SECTION 3: MASSIVE TEMPLATES (5X EXPANSION)
// =============================================================================

const WESTERN_TEMPLATES = {
    // 1. Transit Intro (행성의 움직임)
    transits: [
        "하늘의 별들이 당신의 차트를 부드럽게 감싸고 있습니다.",
        "멀리서 행성의 에너지가 강렬하게 진동하는 날입니다.",
        "별들의 배치가 고요하여 내면을 들여다보기 좋은 밤입니다.",
        "우주의 리듬이 당신의 맥박과 공명하며 춤을 춥니다.",
        "행성들이 각을 이루며 새로운 기회의 문을 두드리고 있습니다.",
        "별빛이 희미하지만, 그만큼 당신의 내면의 빛이 중요한 날입니다.",
        "천체의 움직임이 분주하여 예상치 못한 소식이 올 수 있습니다.",
        "보이지 않는 중력이 당신을 올바른 궤도로 이끌어줍니다.",
        "은하수의 흐름이 당신의 무의식을 자극하는 신비로운 날입니다.",
        "행성들이 춤을 추듯 정렬하여 당신에게 영감을 불어넣습니다.",
        "우주의 거대한 시계가 당신을 위해 특별한 시간을 가리킵니다.",
        "먼 별에서 온 오래된 빛이 당신의 지혜를 깨웁니다.",
        "천상의 하모니가 당신의 일상에 잔잔한 파동을 일으킵니다.",
        "별들의 속삭임이 바람을 타고 당신에게 전해집니다.",
        "행성들의 에너지가 소용돌이치며 변화를 예고합니다.",
        "고요한 밤하늘처럼 당신의 마음도 깊고 넓어지는 날입니다.",
        "유성우가 쏟아지듯 번뜩이는 아이디어가 스쳐 지나갑니다.",
        "태양계의 기운이 당신의 등을 든든하게 받쳐주고 있습니다.",
        "달의 인력이 당신의 감정을 부드럽게 어루만집니다.",
        "금성의 빛이 당신의 일상을 아름답게 물들입니다.",
        "화성의 열기가 당신의 심장을 뜨겁게 만드는 날입니다.",
        "목성의 관대함이 당신에게 여유를 선물합니다.",
        "토성의 엄격함이 당신을 단단하게 성장시킵니다.",
        "천왕성의 번개 같은 에너지가 일상의 권태를 깨뜨립니다.",
        "해왕성의 안개 속에서 진실한 꿈을 발견하게 됩니다.",
        "명왕성의 깊은 힘이 당신의 잠재력을 끌어올립니다.",
        "별자리의 이동이 당신에게 새로운 방향을 제시합니다.",
        "우주의 에너지가 당신을 중심으로 회전하는 듯한 날입니다.",
        "천체의 운행이 당신의 바이오리듬과 완벽한 조화를 이룹니다.",
        "밤하늘의 지도가 당신의 앞길을 비추는 나침반이 됩니다.",
        "우주의 침묵 속에서 당신만의 해답을 찾을 수 있습니다.",
        "행성들의 배치가 마치 당신을 위한 무대를 준비한 듯합니다."
    ],
    // 2. Element Advice (4원소별 맞춤 조언 - 20개씩)
    advice: {
        fire: [ // 양자리, 사자자리, 사수자리
            "지금은 망설임보다는 불꽃같은 행동이 필요한 순간입니다.",
            "당신의 열정이 주변을 따뜻하게 데우는 등불이 되어줍니다.",
            "직관을 믿으세요. 논리보다 당신의 첫 느낌이 정답입니다.",
            "솔직하고 당당한 태도가 오히려 복잡한 문제를 단순하게 만듭니다.",
            "에너지가 넘칩니다. 운동이나 새로운 프로젝트로 발산하세요.",
            "도전하는 것을 두려워하지 마세요. 불은 멈추면 꺼집니다.",
            "당신의 카리스마가 사람들을 이끄는 강력한 힘이 됩니다.",
            "작은 불씨가 큰 불이 되듯, 사소한 시작이 중요합니다.",
            "열정의 온도를 조절하세요. 너무 뜨거우면 지칠 수 있습니다.",
            "자신의 주장을 명확히 하되, 상대방의 마음도 헤아리세요.",
            "창조적인 에너지가 폭발하는 시기니 예술적인 활동을 해보세요.",
            "당신의 용기가 누군가에게는 큰 희망이 될 수 있습니다.",
            "경쟁을 즐기세요. 당신은 승리할 준비가 되어 있습니다.",
            "목표를 향해 화살처럼 직진하세요. 지금은 집중할 때입니다.",
            "낙관적인 태도가 막힌 길을 뚫어주는 열쇠가 됩니다.",
            "자신을 믿는 힘이 가장 강력한 무기입니다.",
            "모험을 떠나기에 좋은 날입니다. 낯선 곳으로 가보세요.",
            "솔직한 감정 표현이 오해를 풀고 관계를 개선합니다.",
            "당신의 빛나는 존재감이 어디서든 주목받게 할 것입니다.",
            "지루함을 견디기보다 새로운 변화를 스스로 만들어보세요."
        ],
        earth: [ // 황소자리, 처녀자리, 염소자리
            "서두르지 마세요. 대지처럼 굳건하게 자리를 지키는 것이 이깁니다.",
            "현실적인 계획이 빛을 발합니다. 숫자를 꼼꼼히 확인하세요.",
            "눈에 보이는 결과물이 나오는 날입니다. 마지막까지 디테일을 챙기세요.",
            "자연과 가까이 하세요. 흙의 기운이 당신을 충전해줍니다.",
            "오래된 물건을 정리하거나 재정 상태를 점검하기 딱 좋은 날입니다.",
            "꾸준함이 비범함을 만듭니다. 오늘 한 걸음이 중요합니다.",
            "약속은 반드시 지키세요. 신뢰가 당신의 가장 큰 자산입니다.",
            "몸의 감각에 집중하세요. 맛있는 음식이나 편안한 휴식이 필요합니다.",
            "안정을 추구하는 것이 겁쟁이가 아님을 명심하세요.",
            "구체적인 목표를 세우고 하나씩 체크해 나가는 기쁨을 누리세요.",
            "당신의 꼼꼼함이 위기를 미리 방지할 것입니다.",
            "물질적인 풍요로움보다 마음의 여유를 먼저 챙기세요.",
            "기반을 다지는 시기입니다. 기초공사가 튼튼해야 높이 쌓습니다.",
            "실용적인 접근이 복잡한 문제를 해결하는 열쇠입니다.",
            "인내심을 가지세요. 씨앗이 싹트기까지는 시간이 필요합니다.",
            "전통과 규칙을 존중하는 것이 오늘은 유리하게 작용합니다.",
            "손으로 무언가를 만드는 취미가 힐링이 될 수 있습니다.",
            "타인의 평가보다 스스로의 만족감이 더 중요한 날입니다.",
            "책임감 있는 태도가 주위의 인정을 받게 합니다.",
            "단순하고 소박한 삶의 방식에서 진정한 행복을 찾으세요."
        ],
        air: [ // 쌍둥이자리, 천칭자리, 물병자리
            "새로운 정보가 바람을 타고 옵니다. 귀를 열어두세요.",
            "대화가 해결책입니다. 혼자 고민하지 말고 주변에 물어보세요.",
            "객관적인 시선이 필요합니다. 한 발자국 물러서서 관망하세요.",
            "지적인 호기심이 왕성해집니다. 책을 읽거나 강의를 들어보세요.",
            "유연함이 무기입니다. 계획이 바뀌어도 당황하지 마세요.",
            "소통의 창구가 열려있습니다. 오해를 풀기에 적기입니다.",
            "다양한 사람들과의 교류가 새로운 기회를 가져옵니다.",
            "고정관념을 버리고 자유롭게 상상의 나래를 펼쳐보세요.",
            "논리적인 사고가 감정적인 혼란을 잠재워 줄 것입니다.",
            "가벼운 산책이나 드라이브가 머리를 맑게 해줍니다.",
            "아이디어가 샘솟습니다. 메모하는 습관을 잊지 마세요.",
            "중립적인 태도를 유지하세요. 어느 한쪽으로 치우치지 마세요.",
            "변화에 민감하게 반응하되, 중심은 잃지 않도록 하세요.",
            "당신의 재치 있는 말 한마디가 분위기를 반전시킵니다.",
            "새로운 기술이나 트렌드를 익히기에 좋은 날입니다.",
            "협력과 조화가 혼자 하는 것보다 더 큰 성과를 냅니다.",
            "네트워크를 확장하세요. 사람이 곧 자산입니다.",
            "분석적인 접근보다는 넓은 시야로 전체를 조망하세요.",
            "자유로운 영혼처럼 구속받지 않는 시간을 가져보세요.",
            "토론과 논쟁을 즐기되, 감정싸움으로 번지지 않게 주의하세요."
        ],
        water: [ // 게자리, 전갈자리, 물고기자리
            "감정의 파도가 칠 수 있습니다. 오늘은 마음의 소리를 경청하세요.",
            "꿈자리가 선명하거나 예감이 적중할 수 있습니다.",
            "누군가를 위로할 때 당신의 마음도 함께 치유됩니다.",
            "예술적인 영감이 샘솟습니다. 그림을 그리거나 글을 써보세요.",
            "흐르는 물처럼 순리대로 맡기세요. 억지로 하려 하지 마세요.",
            "직관력이 최고조에 달합니다. 머리보다 가슴을 따르세요.",
            "깊은 공감 능력이 관계를 더욱 돈독하게 만듭니다.",
            "혼자만의 시간을 가지며 내면을 정화하는 것이 좋습니다.",
            "과거의 기억이 떠오르더라도 얽매이지 말고 흘려보내세요.",
            "당신의 친절과 배려가 결국 자신에게 돌아옵니다.",
            "무의식의 세계를 탐구해보세요. 명상이나 요가가 좋습니다.",
            "감수성이 풍부해지는 날, 슬픈 영화 한 편이 위로가 됩니다.",
            "비밀을 지키세요. 신비로움이 당신의 매력입니다.",
            "가족이나 가까운 사람들과의 유대감을 확인하세요.",
            "상상력이 현실이 될 수 있습니다. 긍정적인 꿈을 꾸세요.",
            "물 흐르듯 유연하게 대처하면 어떤 장애물도 넘을 수 있습니다.",
            "자신의 감정을 부정하지 말고 있는 그대로 받아들이세요.",
            "치유의 에너지가 강한 날입니다. 몸과 마음을 돌보세요.",
            "주변의 분위기에 휩쓸리지 말고 자신의 중심을 잡으세요.",
            "사랑과 연민의 마음으로 세상을 바라보면 아름다워 보입니다."
        ]
    },
    // 3. Situational Closing (상황별 마무리)
    closings: [
        "오늘 하루는 자신에게 작은 선물을 해도 좋습니다.",
        "저녁에는 스마트폰을 멀리하고 명상의 시간을 가져보세요.",
        "오랜 친구에게 안부 문자를 보내면 뜻밖의 기쁨이 있습니다.",
        "중요한 결정은 내일 아침으로 미루는 것이 현명합니다.",
        "오늘 마시는 커피 한 잔이 유난히 달콤할 것입니다.",
        "집이나 책상 주변을 정리하면 머릿속도 맑아집니다.",
        "예상치 못한 칭찬을 듣게 될 수 있으니 미소를 준비하세요.",
        "오늘의 작은 실수는 더 큰 성공을 위한 밑거름입니다.",
        "잠들기 전, 오늘 하루 감사했던 일 세 가지를 떠올려보세요.",
        "당신의 미소가 누군가의 하루를 밝혀줄 수 있습니다.",
        "오늘밤 꿈속에서 멋진 영감을 얻을지도 모릅니다.",
        "따뜻한 목욕으로 하루의 피로를 씻어내세요.",
        "내일은 오늘보다 더 빛나는 하루가 될 것입니다.",
        "자신을 너무 몰아세우지 마세요. 당신은 충분히 잘하고 있습니다.",
        "하늘을 한번 올려다보세요. 별들이 당신을 응원합니다.",
        "좋아하는 음악을 들으며 하루를 마무리하는 여유를 가지세요.",
        "작은 친절이 큰 행복으로 돌아오는 것을 잊지 마세요.",
        "걱정은 잠시 내려놓고 편안한 휴식을 취하세요.",
        "당신의 존재만으로도 세상은 더 아름다워집니다.",
        "오늘 걷는 이 길이 결국 꽃길로 이어질 것입니다.",
        "마음의 짐을 덜어내면 내일 더 가볍게 날아오를 수 있습니다.",
        "거울을 보고 스스로에게 '수고했어'라고 말해주세요.",
        "사랑하는 사람과 함께하는 저녁 식사가 최고의 보약입니다.",
        "지금의 어려움은 곧 지나가는 소나기일 뿐입니다.",
        "당신의 잠재력은 아직 다 깨어나지 않았습니다. 기대하세요.",
        "오늘 배운 교훈이 먼 훗날 큰 지혜가 될 것입니다.",
        "평온한 마음으로 잠자리에 들면 내일 아침이 상쾌합니다.",
        "행운은 준비된 자에게 찾아온다는 것을 기억하세요.",
        "당신의 따뜻한 말 한마디가 세상을 바꿉니다.",
        "오늘 하루도 당신의 인생이라는 책의 멋진 한 페이지였습니다.",
        "내일의 태양은 당신을 위해 다시 떠오를 것입니다.",
        "편안한 밤 되세요. 우주가 당신을 지켜줍니다."
    ]
};

const EASTERN_TEMPLATES = {
    // 1. Iljin Intro (일진/기운 묘사)
    iljin: [
        "오늘은 기상(氣像)이 맑고 청명하여 만물이 소생하는 날입니다.",
        "안개가 낀 듯 흐릿하나 곧 걷히고 해가 뜰 형상입니다.",
        "강한 바람이 불어오니 중심을 잡고 버텨야 하는 날입니다.",
        "비 온 뒤 땅이 굳어지듯, 시련 뒤에 결실이 맺히는 형국입니다.",
        "잔잔한 호수에 돌을 던진 듯 파문이 일어나는 변화의 날입니다.",
        "오래된 나무가 깊게 뿌리를 내리듯 안정을 찾아가는 날입니다.",
        "불길이 맹렬하게 타오르듯 의욕이 넘치나 조절이 필요합니다.",
        "차가운 금속처럼 이성적이고 냉철한 판단이 서는 날입니다.",
        "구름 사이로 한 줄기 빛이 내려오니 희망이 보이는 날입니다.",
        "대지가 품은 열기가 솟아오르듯 잠재력이 깨어나는 형상입니다.",
        "흐르는 물이 바다에 닿듯, 노력의 결과가 드넓게 펼쳐집니다.",
        "바위 틈에서 피어난 꽃처럼 강인한 생명력이 느껴지는 하루입니다.",
        "가을 하늘처럼 높고 푸르니, 마음의 여유가 깃들 것입니다.",
        "겨울잠에서 깨어난 개구리처럼 활기찬 움직임이 시작됩니다.",
        "용이 승천하듯 기운이 힘차게 솟구치는 길일입니다.",
        "달빛이 연못을 비추듯 은은하고 평화로운 기운이 감돕니다.",
        "천둥이 치고 비가 내리니 변화의 조짐이 강하게 나타납니다.",
        "산 정상에 올라 세상을 굽어보듯 시야가 넓어지는 날입니다.",
        "씨앗이 단단한 껍질을 깨고 싹을 틔우는 인내가 필요합니다.",
        "황금 들판에 곡식이 무르익듯 풍요로운 결실이 예상됩니다.",
        "새벽 닭이 울어 아침을 알리듯, 새로운 시작을 알리는 징조입니다.",
        "노을이 붉게 물들듯 열정적인 마무리가 중요한 날입니다.",
        "깊은 산속 옹달샘처럼 맑은 정신을 유지하는 것이 좋습니다.",
        "거친 파도를 헤치고 나가는 배처럼 도전적인 자세가 필요합니다.",
        "이슬비가 옷을 적시듯, 서서히 스며드는 행운이 있습니다.",
        "대나무처럼 곧고 바른 마음가짐이 귀인을 부르는 형상입니다.",
        "모닥불처럼 주위를 따뜻하게 밝히는 긍정의 힘이 넘칩니다.",
        "별들이 길을 안내하듯, 직감이 당신을 옳은 곳으로 이끕니다.",
        "단단한 흙을 뚫고 나오는 새싹의 기상을 본받아야 할 때입니다.",
        "강물이 굽이치며 바다로 향하듯, 인생의 여정을 즐기십시오.",
        "오래 묵힌 장맛처럼 깊이 있는 지혜가 빛을 발하는 날입니다.",
        "하늘과 땅의 기운이 조화를 이루니 매사가 순조롭습니다."
    ],
    // 2. Compatibility Logic (상생/상극에 따른 풀이 - 20개씩)
    harmony: [ // 상생 (Good)
        "귀인이 동쪽에서 찾아오니 막힌 일이 술술 풀립니다.",
        "물 들어올 때 노 젓는 격이라, 하는 일마다 성과가 따릅니다.",
        "주변 사람들과의 합(合)이 좋아 협업하기에 최적의 날입니다.",
        "생각지도 못한 재물이나 먹을 복이 따르는 운수입니다.",
        "당신의 기운이 상승 기류를 탔으니 자신감을 가져도 좋습니다.",
        "가뭄에 단비가 내리듯, 기다리던 소식을 듣게 될 것입니다.",
        "손을 대는 일마다 금으로 변하는 미다스의 손이 되는 날입니다.",
        "천군만마를 얻은 듯 든든한 조력자가 나타날 수 있습니다.",
        "순풍에 돛을 단 배처럼 거침없이 나아가는 하루입니다.",
        "작은 노력으로 큰 결실을 맺으니 가성비 최고의 날입니다.",
        "당신의 말 한마디가 천냥 빚을 갚는 마법을 부립니다.",
        "오랜 오해나 갈등이 눈 녹듯 사라지는 화해의 기운입니다.",
        "뜻밖의 행운이 선물처럼 찾아오니 설레는 마음으로 기다리세요.",
        "오늘의 투자는 훗날 큰 이익으로 돌아올 것입니다.",
        "주변의 칭찬과 인정을 받으니 어깨가 으쓱해지는 날입니다.",
        "무엇을 하든 운이 따르니, 망설였던 일에 도전해보세요.",
        "마음이 편안하니 몸도 건강해지는 힐링의 하루입니다.",
        "좋은 인연을 만날 수 있으니 사람 많이 모이는 곳이 길합니다.",
        "당신의 아이디어가 빛을 발하여 모두를 놀라게 할 것입니다.",
        "하늘이 돕고 땅이 도우니 두려울 것이 없는 대길(大吉)입니다."
    ],
    conflict: [ // 상극 (Bad/Caution)
        "오늘은 돌다리도 두들겨 보고 건너야 하는 신중함이 필요합니다.",
        "의욕이 앞서 실수를 할 수 있으니 한 템포 쉬어가세요.",
        "가까운 사람과의 사소한 언쟁이 커질 수 있으니 말을 아끼세요.",
        "무리한 투자는 금물이며, 지금 가진 것을 지키는 것이 이익입니다.",
        "예상치 못한 변수가 생길 수 있으니 플랜 B를 준비하세요.",
        "급하게 서두르면 체할 수 있습니다. 천천히 꼭꼭 씹으세요.",
        "달콤한 유혹을 조심하세요. 겉보기와 다를 수 있습니다.",
        "자존심을 내세우다가 실속을 챙기지 못할 수 있습니다.",
        "오늘은 ‘아니오’라고 말하는 용기가 필요할 수 있습니다.",
        "중요한 계약이나 약속은 꼼꼼하게 다시 한번 확인하세요.",
        "건강에 유의하세요. 과로나 스트레스는 금물입니다.",
        "남의 떡이 더 커 보일 수 있지만, 가진 것에 만족하세요.",
        "구설수에 휘말릴 수 있으니 언행을 각별히 조심해야 합니다.",
        "계획대로 되지 않아도 실망하지 마세요. 전화위복이 될 수 있습니다.",
        "운전이나 기계 조작 시 각별한 주의가 요구됩니다.",
        "지출이 늘어날 수 있으니 지갑을 닫는 것이 현명합니다.",
        "감정 기복이 심해질 수 있습니다. 명상으로 마음을 다스리세요.",
        "고집을 부리면 고립될 수 있습니다. 귀를 열고 경청하세요.",
        "옛 실수나 좋지 않은 기억이 떠오르면 빨리 털어내세요.",
        "오늘은 잠시 멈춤 버튼을 누르고 휴식을 취하는 것이 상책입니다."
    ],
    neutral: [ // 평이 (Mid)
        "크게 좋지도 나쁘지도 않은 평온한 하루가 예상됩니다.",
        "흐르는 물처럼 무리하지 않고 순리대로 행하면 길합니다.",
        "소소한 행복에 감사하면 복이 절로 굴러들어옵니다.",
        "새로운 일보다는 하던 일을 꾸준히 마무리하는 것이 좋습니다.",
        "중용(中庸)의 미덕을 지키면 저녁에 마음이 편안할 것입니다.",
        "평범함 속에 비범함이 숨어 있습니다. 일상을 소중히 하세요.",
        "너무 튀지 않고 중간만 가도 성공하는 날입니다.",
        "오늘 하루는 무소식이 희소식이라 생각하세요.",
        "균형을 잡는 것이 중요합니다. 과유불급을 명심하세요.",
        "주변을 둘러보며 숨 고르기를 하기에 적당한 날입니다.",
        "큰 변화는 없지만, 그만큼 안정적인 하루가 될 것입니다.",
        "자신을 돌아보는 시간을 가지면 내일 더 성장할 수 있습니다.",
        "무리하지 않는 선에서 가벼운 운동이 활력을 줍니다.",
        "가까운 지인들과 담소를 나누며 스트레스를 푸세요.",
        "기다림의 미학이 필요한 날입니다. 조급해하지 마세요.",
        "현재 상태를 유지하는 것이 최선의 전략일 수 있습니다.",
        "객관적인 시각을 유지하면 실수를 줄일 수 있습니다.",
        "자연스러운 흐름에 몸을 맡기면 편안해집니다.",
        "오늘의 평온함이 내일의 도약을 위한 에너지 충전이 됩니다.",
        "적당한 거리두기가 인간관계를 부드럽게 합니다."
    ],
    // 3. Action Suggestion (실천 조언)
    actions: [
        "오늘은 붉은색 계열의 옷이나 소품이 기운을 북돋아 줍니다.",
        "동쪽 방향으로 잠시 산책을 다녀오면 좋은 기운을 받습니다.",
        "따뜻한 차를 마시며 마음을 안정시키는 시간이 필요합니다.",
        "약속 시간보다 10분 일찍 도착하면 행운이 따릅니다.",
        "지갑을 정리하거나 영수증을 버리면 금전운이 트입니다.",
        "부모님이나 웃어른께 안부 전화를 드리면 좋습니다.",
        "오늘 점심은 면 요리나 길쭉한 음식이 길합니다.",
        "잠들기 전 오늘 감사한 일 3가지를 떠올려보세요.",
        "아침에 따뜻한 물 한 잔이 하루의 활력을 줍니다.",
        "책상이나 작업 공간을 정리하면 머리가 맑아집니다.",
        "엘리베이터 대신 계단을 이용하면 건강운이 상승합니다.",
        "오늘 하루 채식을 해보는 것도 몸을 가볍게 합니다.",
        "좋아하는 향수를 뿌리거나 향초를 켜보세요.",
        "거울을 보며 활짝 웃는 연습을 하면 인상이 좋아집니다.",
        "가까운 화원에 들러 작은 식물 하나를 들이세요.",
        "오늘은 일찍 귀가하여 가족과 시간을 보내세요.",
        "필요 없는 물건 하나를 버리거나 기부하세요.",
        "하늘 사진을 찍어보세요. 시야가 트이는 느낌을 줍니다.",
        "점심 식사 후 가벼운 스트레칭으로 몸을 풀어주세요.",
        "평소 듣지 않던 장르의 음악을 들어보세요.",
        "손편지나 정성스러운 메모를 남기면 감동을 줍니다.",
        "오늘은 스마트폰 사용 시간을 조금 줄여보세요.",
        "남쪽으로 머리를 두고 자면 숙면을 취할 수 있습니다.",
        "달을 보며 소원을 빌어보세요. 간절하면 통합니다.",
        "따뜻한 족욕이 하루의 피로를 말끔히 풀어줍니다.",
        "새로운 길로 출근하거나 산책해보세요. 신선한 자극이 됩니다.",
        "오래된 연락처를 정리하여 인맥 다이어트를 하세요.",
        "제철 과일을 먹으면 비타민과 함께 행운도 섭취합니다.",
        "서점이나 도서관에 들러 제목이 끌리는 책을 펼쳐보세요.",
        "오늘 하루는 긍정적인 말만 쓰기로 다짐해보세요.",
        "작은 기부나 선행이 큰 복으로 돌아옵니다."
    ]
};

const LUCKY_ITEMS = {
    colors: ["로열 블루", "포레스트 그린", "크림 베이지", "미드나잇 블랙", "버건디 레드", "머스타드 옐로우", "퓨어 화이트", "차콜 그레이"],
    items: ["손목시계", "은반지", "다이어리", "향수", "텀블러", "이어폰", "안경/선글라스", "스카프/목도리"],
    foods: ["파스타", "비빔밥", "샌드위치", "초밥", "샐러드", "된장찌개", "과일 주스", "초콜릿"],
    directions: ["동쪽", "서쪽", "남쪽", "북쪽", "남동쪽", "북서쪽"],
    numbers: ["1", "3", "7", "8", "9", "11", "24"]
};

// =============================================================================
// SECTION 4: ENGINE LOGIC
// =============================================================================

function getSeededRandom(seedString) {
    let h = 0x811c9dc5;
    for (let i = 0; i < seedString.length; i++) {
        h ^= seedString.charCodeAt(i);
        h = Math.imul(h, 0x01000193);
    }
    h >>>= 0;
    const load = (h / 4294967296);
    return load; // 0.0 ~ 1.0
}

function pick(array, seed) {
    const idx = Math.floor(getSeededRandom(seed) * array.length);
    return array[idx];
}

// ----------------------------------------------------
// Public Export 1: Western Horoscope
// ----------------------------------------------------
export function getDailyHoroscope(name, birthdate) {
    if (!birthdate) return null;

    const today = new Date();
    const dateStr = `${today.getFullYear()}${today.getMonth()}${today.getDate()}`;
    // Base Seed
    const seed = `${dateStr}-${name}-WESTERN`;

    // 1. Identify Sign & Element
    const signName = getZodiacName(birthdate);
    const zInfo = ZODIAC_SIGNS[signName];

    // 2. Simulate Planetary Aspect (Randomly select one for the day/user combo)
    const aspect = pick(PLANETARY_ASPECTS, seed + "aspect");

    // 3. Build Sentence Parts
    const transitText = pick(WESTERN_TEMPLATES.transits, seed + "transit");
    const adviceText = pick(WESTERN_TEMPLATES.advice[zInfo.element], seed + "advice");
    const closingText = pick(WESTERN_TEMPLATES.closings, seed + "closing");

    // 4. Construct Full Text
    // Structure: [Transit Intro] + [Aspect Effect] + [Element Advice] + [Closing]
    // Clean, expert tone.
    let fullText = `${transitText} `;
    fullText += `오늘은 **${aspect.name}**의 영향으로 ${aspect.desc}입니다. `;
    fullText += `${adviceText} `;
    fullText += `${closingText}`;

    return {
        sign: signName,
        ruler: zInfo.ruler,
        element: zInfo.element,
        aspect: aspect.name,
        text: fullText
    };
}

// ----------------------------------------------------
// Public Export 2: Oriental Fortune
// ----------------------------------------------------
export function getDailyOrientalFortune(name, birthdate) {
    if (!birthdate) return null;

    const today = new Date();
    const dateStr = `${today.getFullYear()}${today.getMonth()}${today.getDate()}`;
    const seed = `${dateStr}-${name}-EASTERN`;

    // 1. Identify Zodiac & Element
    const zodiacName = getChineseZodiacName(birthdate);
    const myElementKey = ORIENTAL_ZODIAC[zodiacName]; // e.g., 'water'

    // 2. Simulate Daily Iljin (Day Element)
    const elementKeys = Object.keys(FIVE_ELEMENTS);
    const dailyElementKey = pick(elementKeys, "DAILY_ILJIN_" + dateStr);
    const dailyElement = FIVE_ELEMENTS[dailyElementKey];

    // 3. Determine Relational Status (Simple Harmony Logic)
    // Wood->Fire->Earth->Metal->Water->Wood
    const supportMap = { "wood": "fire", "fire": "earth", "earth": "metal", "metal": "water", "water": "wood" };
    const conflictMap = { "wood": "earth", "fire": "metal", "earth": "water", "metal": "wood", "water": "fire" };

    let status = "neutral";
    if (supportMap[myElementKey] === dailyElementKey || supportMap[dailyElementKey] === myElementKey) {
        status = "harmony";
    } else if (conflictMap[myElementKey] === dailyElementKey || conflictMap[dailyElementKey] === myElementKey) {
        status = "conflict";
    }

    // 4. Build Sentence Parts
    const introText = pick(EASTERN_TEMPLATES.iljin, seed + "iljin");
    // Pick specific advice based on harmony status
    let statusText = "";
    if (status === "harmony") statusText = pick(EASTERN_TEMPLATES.harmony, seed + "status");
    else if (status === "conflict") statusText = pick(EASTERN_TEMPLATES.conflict, seed + "status");
    else statusText = pick(EASTERN_TEMPLATES.neutral, seed + "status");

    const actionText = pick(EASTERN_TEMPLATES.actions, seed + "action");

    // 5. Construct Full Text
    // Structure: [Intro] + [So, status analysis] + [Action]
    let fullText = `${introText} `;
    fullText += `오늘의 일진인 **${dailyElement.name}** 기운이 당신과 만나 ${statusText} `;
    fullText += `${actionText}`;

    return {
        sign: zodiacName,
        element: myElementKey,
        dailyElement: dailyElement.name, // e.g. "화(火)"
        status: status,
        text: fullText
    };
}

// ----------------------------------------------------
// Public Export 3: Lucky Prescription
// ----------------------------------------------------
export function getLuckyPrescription(name, birthdate) {
    const today = new Date();
    const dateStr = `${today.getFullYear()}${today.getMonth()}${today.getDate()}`;
    const seed = `${dateStr}-${name}-LUCKY`;

    return {
        color: pick(LUCKY_ITEMS.colors, seed + "col"),
        item: pick(LUCKY_ITEMS.items, seed + "item"),
        food: pick(LUCKY_ITEMS.foods, seed + "food"),
        direction: pick(LUCKY_ITEMS.directions, seed + "dir"),
        number: pick(LUCKY_ITEMS.numbers, seed + "num")
    };
}

// ----------------------------------------------------
// Helpers
// ----------------------------------------------------
function getZodiacName(dateStr) {
    const date = new Date(dateStr);
    const m = date.getMonth() + 1;
    const d = date.getDate();

    if ((m == 3 && d >= 21) || (m == 4 && d <= 19)) return "양자리";
    if ((m == 4 && d >= 20) || (m == 5 && d <= 20)) return "황소자리";
    if ((m == 5 && d >= 21) || (m == 6 && d <= 21)) return "쌍둥이자리";
    if ((m == 6 && d >= 22) || (m == 7 && d <= 22)) return "게자리";
    if ((m == 7 && d >= 23) || (m == 8 && d <= 22)) return "사자자리";
    if ((m == 8 && d >= 23) || (m == 9 && d <= 22)) return "처녀자리";
    if ((m == 9 && d >= 23) || (m == 10 && d <= 22)) return "천칭자리";
    if ((m == 10 && d >= 23) || (m == 11 && d <= 22)) return "전갈자리";
    if ((m == 11 && d >= 23) || (m == 12 && d <= 21)) return "사수자리";
    if ((m == 12 && d >= 22) || (m == 1 && d <= 19)) return "염소자리";
    if ((m == 1 && d >= 20) || (m == 2 && d <= 18)) return "물병자리";
    return "물고기자리";
}

function getChineseZodiacName(dateStr) {
    const year = new Date(dateStr).getFullYear();
    const animals = ["원숭이띠", "닭띠", "개띠", "돼지띠", "쥐띠", "소띠", "호랑이띠", "토끼띠", "용띠", "뱀띠", "말띠", "양띠"];
    return animals[year % 12];
}
